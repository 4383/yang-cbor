<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>CBOR Encoding of Data Modeled with YANG</title>

  <style type="text/css">/*<![CDATA[*/
@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}

@media screen and (min-width: 1024px) {
  ul.toc, #rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    padding: 0 1em;
    z-index: 1;
  }
  #rfc\.toc {
    top: 16px;
  }
  ul.toc {
    top: 80px;
    overflow: auto;
  }

  body {
    padding-left: 1.5em;
    padding-right: 29em;
  }
}

body {
  font: 15px "Helvetica Neue",Helvetica,Arial,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 130%;
  margin: 2.5em auto;
  max-width: 724px;
}

.title, .filename, h1, h2, h3, h4 {
  font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size-adjust: 0.5;
  font-weight: 500;
  color: #333;
  line-height: 100%;
  margin: 0.8em 0 0.3em;
}
.title { font-size: 36px; }
h1 { font-size: 30px; }
h2 { font-size: 24px; }
h3, h4 { font-size: 18px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

ul.toc li {
  list-style: none;
  text-indent: -2.5em;
  padding-left: 2.5em;
  padding-bottom: 5px;
  margin: 0;
}
ul.toc, ul.toc ul {
  margin: 0 0 0 1.5em;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header {
  width: 100%;
}
table.header td {
  border: none;
  background-color: transparent;
  color: black;
}
.filename {
  color: rgb(119, 119, 119);
  font-size: 23px;
  font-weight: normal;
  height: auto;
  line-height: 100%;
}
#rfc\.abstract+p {
  font-size: 20px;
  font-weight: 300;
  line-height: 130%;
}

samp, tt, code, pre {
  font: 11pt consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure {
  font-style: italic;
  margin: 0 1.5em;
}

address {
  margin: 10px 0 0;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn {
  font-weight: bold;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

ol, ul, li, p {
  padding: 0;
  margin: 0.5em 0 0.5em 2em;
}
li, p {
  margin-left: 0;
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology and Notation">
<link href="#rfc.section.3" rel="Chapter" title="3 Properties of the CBOR Encoding">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 CBOR diagnostic notation">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 YANG Schema Item iDentifier (SID)">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Name">
<link href="#rfc.section.4" rel="Chapter" title="4 Encoding of YANG Schema Node Instances">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 The &#8216;leaf&#8217;">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 The &#8216;container&#8217; and other collections">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 SIDs as keys">
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 Names as keys">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 The &#8216;leaf-list&#8217;">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 The &#8216;list&#8217; and &#8216;list&#8217; instance(s)">
<link href="#rfc.section.4.4.1" rel="Chapter" title="4.4.1 SIDs as keys">
<link href="#rfc.section.4.4.2" rel="Chapter" title="4.4.2 Names as keys">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 The &#8216;anydata&#8217;">
<link href="#rfc.section.4.6" rel="Chapter" title="4.6 The &#8216;anyxml&#8217;">
<link href="#rfc.section.5" rel="Chapter" title="5 Encoding of YANG data templates">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 SIDs as keys">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Names as keys">
<link href="#rfc.section.6" rel="Chapter" title="6 Representing YANG Data Types in CBOR">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 The unsigned integer Types">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 The integer Types">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 The &#8216;decimal64&#8217; Type">
<link href="#rfc.section.6.4" rel="Chapter" title="6.4 The &#8216;string&#8217; Type">
<link href="#rfc.section.6.5" rel="Chapter" title="6.5 The &#8216;boolean&#8217; Type">
<link href="#rfc.section.6.6" rel="Chapter" title="6.6 The &#8216;enumeration&#8217; Type">
<link href="#rfc.section.6.7" rel="Chapter" title="6.7 The &#8216;bits&#8217; Type">
<link href="#rfc.section.6.8" rel="Chapter" title="6.8 The &#8216;binary&#8217; Type">
<link href="#rfc.section.6.9" rel="Chapter" title="6.9 The &#8216;leafref&#8217; Type">
<link href="#rfc.section.6.10" rel="Chapter" title="6.10 The &#8216;identityref&#8217; Type">
<link href="#rfc.section.6.10.1" rel="Chapter" title="6.10.1 SIDs as identityref">
<link href="#rfc.section.6.10.2" rel="Chapter" title="6.10.2 Name as identityref">
<link href="#rfc.section.6.11" rel="Chapter" title="6.11 The &#8216;empty&#8217; Type">
<link href="#rfc.section.6.12" rel="Chapter" title="6.12 The &#8216;union&#8217; Type">
<link href="#rfc.section.6.13" rel="Chapter" title="6.13 The &#8216;instance-identifier&#8217; Type">
<link href="#rfc.section.6.13.1" rel="Chapter" title="6.13.1 SIDs as instance-identifier">
<link href="#rfc.section.6.13.2" rel="Chapter" title="6.13.2 Names as instance-identifier">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 Tags Registry">
<link href="#rfc.section.9" rel="Chapter" title="9 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.22.2 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Veillette, M., Ed., Petrov, I., Ed., and A. Pelov" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-core-yang-cbor-09" />
  <meta name="dct.issued" scheme="ISO8601" content="2019-04-01" />
  <meta name="dct.abstract" content="This document defines encoding rules for serializing configuration data, state data, RPC input and RPC output, Action input, Action output and notifications defined within YANG modules using the Concise Binary Object Representation (CBOR) ." />
  <meta name="description" content="This document defines encoding rules for serializing configuration data, state data, RPC input and RPC output, Action input, Action output and notifications defined within YANG modules using the Concise Binary Object Representation (CBOR) ." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">M. Veillette, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Trilliant Networks Inc.</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">I. Petrov, Ed.</td>
</tr>
<tr>
<td class="left">Expires: October 3, 2019</td>
<td class="right">A. Pelov</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Acklio</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">April 01, 2019</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">CBOR Encoding of Data Modeled with YANG<br />
  <span class="filename">draft-ietf-core-yang-cbor-09</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document defines encoding rules for serializing configuration data, state data, RPC input and RPC output, Action input, Action output and notifications defined within YANG modules using the Concise Binary Object Representation (CBOR) <a href="#RFC7049" class="xref">[RFC7049]</a>.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on October 3, 2019.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2019 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology and Notation</a>
</li>
<li>3.   <a href="#rfc.section.3">Properties of the CBOR Encoding</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">CBOR diagnostic notation</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">YANG Schema Item iDentifier (SID)</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Name</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">Encoding of YANG Schema Node Instances</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">The &#8216;leaf&#8217;</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">The &#8216;container&#8217; and other collections</a>
</li>
<ul><li>4.2.1.   <a href="#rfc.section.4.2.1">SIDs as keys</a>
</li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">Names as keys</a>
</li>
</ul><li>4.3.   <a href="#rfc.section.4.3">The &#8216;leaf-list&#8217;</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">The &#8216;list&#8217; and &#8216;list&#8217; instance(s)</a>
</li>
<ul><li>4.4.1.   <a href="#rfc.section.4.4.1">SIDs as keys</a>
</li>
<li>4.4.2.   <a href="#rfc.section.4.4.2">Names as keys</a>
</li>
</ul><li>4.5.   <a href="#rfc.section.4.5">The &#8216;anydata&#8217;</a>
</li>
<li>4.6.   <a href="#rfc.section.4.6">The &#8216;anyxml&#8217;</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">Encoding of YANG data templates</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">SIDs as keys</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Names as keys</a>
</li>
</ul><li>6.   <a href="#rfc.section.6">Representing YANG Data Types in CBOR</a>
</li>
<ul><li>6.1.   <a href="#rfc.section.6.1">The unsigned integer Types</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">The integer Types</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">The &#8216;decimal64&#8217; Type</a>
</li>
<li>6.4.   <a href="#rfc.section.6.4">The &#8216;string&#8217; Type</a>
</li>
<li>6.5.   <a href="#rfc.section.6.5">The &#8216;boolean&#8217; Type</a>
</li>
<li>6.6.   <a href="#rfc.section.6.6">The &#8216;enumeration&#8217; Type</a>
</li>
<li>6.7.   <a href="#rfc.section.6.7">The &#8216;bits&#8217; Type</a>
</li>
<li>6.8.   <a href="#rfc.section.6.8">The &#8216;binary&#8217; Type</a>
</li>
<li>6.9.   <a href="#rfc.section.6.9">The &#8216;leafref&#8217; Type</a>
</li>
<li>6.10.   <a href="#rfc.section.6.10">The &#8216;identityref&#8217; Type</a>
</li>
<ul><li>6.10.1.   <a href="#rfc.section.6.10.1">SIDs as identityref</a>
</li>
<li>6.10.2.   <a href="#rfc.section.6.10.2">Name as identityref</a>
</li>
</ul><li>6.11.   <a href="#rfc.section.6.11">The &#8216;empty&#8217; Type</a>
</li>
<li>6.12.   <a href="#rfc.section.6.12">The &#8216;union&#8217; Type</a>
</li>
<li>6.13.   <a href="#rfc.section.6.13">The &#8216;instance-identifier&#8217; Type</a>
</li>
<ul><li>6.13.1.   <a href="#rfc.section.6.13.1">SIDs as instance-identifier</a>
</li>
<li>6.13.2.   <a href="#rfc.section.6.13.2">Names as instance-identifier</a>
</li>
</ul></ul><li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<ul><li>8.1.   <a href="#rfc.section.8.1">Tags Registry</a>
</li>
</ul><li>9.   <a href="#rfc.section.9">Acknowledgments</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<ul><li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">The specification of the YANG 1.1 data modelling language <a href="#RFC7950" class="xref">[RFC7950]</a> defines an XML encoding for data instances, i.e. contents of configuration datastores, state data, RPC inputs and outputs, action inputs and outputs, and event notifications.</p>
<p id="rfc.section.1.p.2">A new set of encoding rules has been defined to allow the use of the same data models in environments based on the JavaScript Object Notation (JSON) Data Interchange Format <a href="#RFC7159" class="xref">[RFC7159]</a>. This is accomplished in the JSON Encoding of Data Modeled with YANG specification <a href="#RFC7951" class="xref">[RFC7951]</a>.</p>
<p id="rfc.section.1.p.3">The aim of this document is to define a set of encoding rules for the Concise Binary Object Representation (CBOR) <a href="#RFC7049" class="xref">[RFC7049]</a>. The resulting encoding is more compact compared to XML and JSON and more suitable for Constrained Nodes and/or Constrained Networks as defined by <a href="#RFC7228" class="xref">[RFC7228]</a>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#terminology-and-notation" id="terminology-and-notation">Terminology and Notation</a>
</h1>
<p id="rfc.section.2.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in <a href="#RFC2119" class="xref">[RFC2119]</a>.</p>
<p id="rfc.section.2.p.2">The following terms are defined in <a href="#RFC7950" class="xref">[RFC7950]</a>:</p>
<p></p>

<ul>
<li>action</li>
<li>anydata</li>
<li>anyxml</li>
<li>data node</li>
<li>data tree</li>
<li>datastore</li>
<li>feature</li>
<li>identity</li>
<li>module</li>
<li>notification</li>
<li>RPC</li>
<li>schema node</li>
<li>schema tree</li>
<li>submodule</li>
</ul>
<p id="rfc.section.2.p.4">The following terms are defined in <a href="#RFC8040" class="xref">[RFC8040]</a>:</p>
<p></p>

<ul>
<li>yang-data (YANG extension)</li>
<li>YANG data template</li>
</ul>
<p id="rfc.section.2.p.6">This specification also makes use of the following terminology:</p>
<p></p>

<ul>
<li>child: A schema node defined within a collection such as a container, a list, a case, a notification, an RPC input, an RPC output, an action input, an action output.</li>
<li>delta: Difference between the current SID and a reference SID. A reference SID is defined for each context for which deltas are used.</li>
<li>item: A schema node, an identity, a module, a submodule or a feature defined using the YANG modeling language.</li>
<li>parent: The collection in which a schema node is defined.</li>
<li>YANG Schema Item iDentifier (SID): Unsigned integer used to identify different YANG items.</li>
</ul>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#properties-of-the-cbor-encoding" id="properties-of-the-cbor-encoding">Properties of the CBOR Encoding</a>
</h1>
<p id="rfc.section.3.p.1">This document defines CBOR encoding rules for YANG schema trees and their subtrees.</p>
<p id="rfc.section.3.p.2">A collection such as container, list instance, notification, RPC input, RPC output, action input and action output is serialized using a CBOR map in which each child schema node is encoded using a key and a value. This specification supports two type of CBOR keys; YANG Schema Item iDentifier (SID) as defined in <a href="#sid" class="xref">Section 3.2</a> and names as defined in <a href="#name" class="xref">Section 3.3</a>. Each of these key types is encoded using a specific CBOR type which allows their interpretation during the deserialization process. Protocols or mechanisms implementing this specification can mandate the use of a specific key type.</p>
<p id="rfc.section.3.p.3">In order to minimize the size of the encoded data, the proposed mapping avoids any unnecessary meta-information beyond those natively supported by CBOR. For instance, CBOR tags are used solely in the case of anyxml schema nodes and the union datatype to distinguish explicitly the use of different YANG datatypes encoded using the same CBOR major type.</p>
<p id="rfc.section.3.p.4">Unless specified otherwise by the protocol or mechanism implementing this specification, the infinite lengths encoding as defined in <a href="#RFC7049" class="xref">[RFC7049]</a> section 2.2 SHALL be supported by CBOR decoders.</p>
<p id="rfc.section.3.p.5">Data nodes implemented using a CBOR array, map, byte string, and text string can be instantiated but empty. In this case, they are encoded with a length of zero.</p>
<p id="rfc.section.3.p.6">Application payloads carrying a value serialized using the rules defined by this specification (e.g. CoAP Content-Format) SHOULD include the identifier (e.g. SID, namespace qualified name, instance-identifier) of this value. When SIDs are used as identifiers, the reference SID SHALL be included in the payload to allow stateless conversion of delta values to SIDs. Formats of these application payloads are not defined by the current specification.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#cbor-diagnostic-notation" id="cbor-diagnostic-notation">CBOR diagnostic notation</a>
</h1>
<p id="rfc.section.3.1.p.1">Within this document, CBOR binary contents are represented using an equivalent textual form called CBOR diagnostic notation as defined in <a href="#RFC7049" class="xref">[RFC7049]</a> section 6. This notation is used strictly for documentation purposes and is never used in the data serialization. <a href="#diagnostic-notation-summary" class="xref">Table 1</a> below provides a summary of this notation.</p>
<div id="rfc.table.1"></div>
<div id="diagnostic-notation-summary"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>CBOR diagnostic notation summary</caption>
<thead><tr>
<th class="left">CBOR content</th>
<th class="left">CBOR type</th>
<th class="left">Diagnostic notation</th>
<th class="left">Example</th>
<th class="left">CBOR encoding</th>
</tr></thead>
<tbody>
<tr>
<td class="left">Unsigned integer</td>
<td class="left">0</td>
<td class="left">Decimal digits</td>
<td class="left">123</td>
<td class="left">18 7B</td>
</tr>
<tr>
<td class="left">Negative integer</td>
<td class="left">1</td>
<td class="left">Decimal digits prefixed by a minus sign</td>
<td class="left">-123</td>
<td class="left">38 7A</td>
</tr>
<tr>
<td class="left">Byte string</td>
<td class="left">2</td>
<td class="left">Hexadecimal value enclosed between single quotes and prefixed by an &#8216;h&#8217;</td>
<td class="left">h&#8217;F15C&#8217;</td>
<td class="left">42 f15C</td>
</tr>
<tr>
<td class="left">Text string</td>
<td class="left">3</td>
<td class="left">String of Unicode characters enclosed between double quotes</td>
<td class="left">&#8220;txt&#8221;</td>
<td class="left">63 747874</td>
</tr>
<tr>
<td class="left">Array</td>
<td class="left">4</td>
<td class="left">Comma-separated list of values within square brackets</td>
<td class="left">[ 1, 2 ]</td>
<td class="left">82 01 02</td>
</tr>
<tr>
<td class="left">Map</td>
<td class="left">5</td>
<td class="left">Comma-separated list of key : value pairs within curly braces</td>
<td class="left">{ 1: 123, 2: 456 }</td>
<td class="left">a2 01187B 021901C8</td>
</tr>
<tr>
<td class="left">Boolean</td>
<td class="left">7/20</td>
<td class="left">false</td>
<td class="left">false</td>
<td class="left">F4</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">7/21</td>
<td class="left">true</td>
<td class="left">true</td>
<td class="left">F5</td>
</tr>
<tr>
<td class="left">Null</td>
<td class="left">7/22</td>
<td class="left">null</td>
<td class="left">null</td>
<td class="left">F6</td>
</tr>
<tr>
<td class="left">Not assigned</td>
<td class="left">7/23</td>
<td class="left">undefined</td>
<td class="left">undefined</td>
<td class="left">F7</td>
</tr>
</tbody>
</table>
<p id="rfc.section.3.1.p.2">The following extensions to the CBOR diagnostic notation are supported:</p>
<p></p>

<ul>
<li>Any text within and including a pair of slashes is considered a comment.</li>
<li>Deltas are visualized as numbers preceded by a &#8216;+&#8217; or &#8216;&#8211;&#8217; sign. The use of the &#8216;+&#8217; sign for positive deltas represents an extension to the CBOR diagnostic notation as defined by <a href="#RFC7049" class="xref">[RFC7049]</a> section 6.</li>
</ul>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#sid" id="sid">YANG Schema Item iDentifier (SID)</a>
</h1>
<p id="rfc.section.3.2.p.1">Some of the items defined in YANG <a href="#RFC7950" class="xref">[RFC7950]</a> require the use of a unique identifier.  In both NETCONF <a href="#RFC6241" class="xref">[RFC6241]</a> and RESTCONF <a href="#RFC8040" class="xref">[RFC8040]</a>, these identifiers are implemented using strings.  To allow the implementation of data models defined in YANG in constrained devices and constrained networks, a more compact method to identify YANG items is required. This compact identifier, called YANG Schema Item iDentifier (SID), is an unsigned integer. The following items are identified using SIDs:</p>
<p></p>

<ul>
<li>identities</li>
<li>data nodes</li>
<li>RPCs and associated input(s) and output(s)</li>
<li>actions and associated input(s) and output(s)</li>
<li>notifications and associated information</li>
<li>YANG modules, submodules and features</li>
</ul>
<p id="rfc.section.3.2.p.3">To minimize its size, in certain positions, SIDs are represented using a (signed) delta from a reference SID and the current SID. Conversion from SIDs to deltas and back to SIDs are stateless processes solely based on the data serialized or deserialized.</p>
<p id="rfc.section.3.2.p.4">Mechanisms and processes used to assign SIDs to YANG items and to guarantee their uniqueness is outside the scope of the present specification. If SIDs are to be used, the present specification is used in conjunction with a specification defining this management. One example for such a specification is under development as <a href="#I-D.ietf-core-sid" class="xref">[I-D.ietf-core-sid]</a>.</p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#name" id="name">Name</a>
</h1>
<p id="rfc.section.3.3.p.1">This specification also supports the encoding of YANG item identifiers as string, similar as those used by the JSON Encoding of Data Modeled with YANG <a href="#RFC7951" class="xref">[RFC7951]</a>. This approach can be used to avoid the management overhead associated to SIDs allocation. The main drawback is the significant increase is size of the encoded data.</p>
<p id="rfc.section.3.3.p.2">YANG items identifiers implemented using names MUST be in one of the following forms:</p>
<p></p>

<ul>
<li>simple - the identifier of the YANG item (i.e. schema node or identity).</li>
<li>namespace qualified - the identifier of the YANG item is prefixed with the name of the module in which this item is defined, separated by the colon character (&#8220;:&#8221;).</li>
</ul>
<p id="rfc.section.3.3.p.4">The name of a module determines the namespace of all YANG items defined in that module. If an item is defined in a submodule, then the namespace qualified name uses the name of the main module to which the submodule belongs.</p>
<p id="rfc.section.3.3.p.5">ABNF syntax [RFC5234] of a name is shown in <a href="#namesyntax" class="xref">Figure 1</a>, where the production for &#8220;identifier&#8221; is defined in Section 14 of <a href="#RFC7950" class="xref">[RFC7950]</a>.</p>
<div id="rfc.figure.1"></div>
<div id="namesyntax"></div>
<pre>
name = [identifier ":"] identifier
</pre>
<p class="figure">Figure 1: ABNF Production for a simple or namespace qualified name</p>
<p id="rfc.section.3.3.p.6">A namespace qualified name MUST be used for all members of a top-level CBOR map and then also whenever the namespaces of the data node and its parent node are different. In all other cases, the simple form of the name SHOULD be used.</p>
<p id="rfc.section.3.3.p.7">Definition example:</p>
<pre>
module example-foomod {
  container top {
    leaf foo {
      type uint8;
    }
  }
}

module example-barmod {
  import example-foomod {
    prefix "foomod";
  }
  augment "/foomod:top" {
    leaf bar {
      type boolean;
    }
  }
}
</pre>
<p id="rfc.section.3.3.p.8">A valid CBOR encoding of the &#8216;top&#8217; container is as follow.</p>
<p id="rfc.section.3.3.p.9">CBOR diagnostic notation:</p>
<pre>
{
  "example-foomod:top": {
    "foo": 54,
    "example-barmod:bar": true
  }
}
</pre>
<p id="rfc.section.3.3.p.10">Both the &#8216;top&#8217; container and the &#8216;bar&#8217; leaf defined in a different YANG module as its parent container are encoded as namespace qualified names. The &#8216;foo&#8217; leaf defined in the same YANG module as its parent container is encoded as simple name.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#instance-encoding" id="instance-encoding">Encoding of YANG Schema Node Instances</a>
</h1>
<p id="rfc.section.4.p.1">Schema node instances defined using the YANG modeling language are encoded using CBOR <a href="#RFC7049" class="xref">[RFC7049]</a> based on the rules defined in this section. We assume that the reader is already familiar with both YANG <a href="#RFC7950" class="xref">[RFC7950]</a> and CBOR <a href="#RFC7049" class="xref">[RFC7049]</a>.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#the-leaf" id="the-leaf">The &#8216;leaf&#8217;</a>
</h1>
<p id="rfc.section.4.1.p.1">A &#8216;leaf&#8217; MUST be encoded accordingly to its datatype using one of the encoding rules specified in <a href="#data-types-mapping" class="xref">Section 6</a>.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#container" id="container">The &#8216;container&#8217; and other collections</a>
</h1>
<p id="rfc.section.4.2.p.1">Collections such as containers, list instances, notification contents, rpc inputs, rpc outputs, action inputs and action outputs MUST be encoded using a CBOR map data item (major type 5). A map is comprised of pairs of data items, with each data item consisting of a key and a value. Each key within the CBOR map is set to a schema node identifier, each value is set to the value of this schema node instance according to the instance datatype.</p>
<p id="rfc.section.4.2.p.2">This specification supports two type of CBOR keys; SID as defined in <a href="#sid" class="xref">Section 3.2</a> and names as defined in <a href="#name" class="xref">Section 3.3</a>.</p>
<p id="rfc.section.4.2.p.3">The following examples shows the encoding of a &#8216;system-state&#8217; container instance using SIDs or names.</p>
<p id="rfc.section.4.2.p.4">Definition example from <a href="#RFC7317" class="xref">[RFC7317]</a>:</p>
<pre>
typedef date-and-time {
  type string {
    pattern '\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d+)?(Z|[\+\-]
             \d{2}:\d{2})';
  }
}
   
container system-state {

  container clock {
    leaf current-datetime {
      type date-and-time;
    }

    leaf boot-datetime {
      type date-and-time;
    }
  }
}
</pre>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> <a href="#container-with-sid" id="container-with-sid">SIDs as keys</a>
</h1>
<p id="rfc.section.4.2.1.p.1">CBOR map keys implemented using SIDs MUST be encoded using a CBOR unsigned integer (major type 0) or CBOR negative integer (major type 1), depending on the actual delta or to a SID preceded by the CBOR tag 99.</p>
<p id="rfc.section.4.2.1.p.2">// RFC Ed.: replace 99 by the allocated CBOR tag.</p>
<p id="rfc.section.4.2.1.p.3">Delta values are computed as follows:</p>
<p></p>

<ul>
<li>In the case of a &#8216;container&#8217;, deltas are equal to the SID of the current schema node minus the SID of the parent &#8216;container&#8217;.</li>
<li>In the case of a &#8216;list&#8217;, deltas are equal to the SID of the current schema node minus the SID of the parent &#8216;list&#8217;.</li>
<li>In the case of an &#8216;rpc input&#8217; or &#8216;rcp output&#8217;, deltas are equal to the SID of the current schema node minus the SID of the &#8216;rpc&#8217;.</li>
<li>In the case of an &#8216;action input&#8217; or &#8216;action output&#8217;, deltas are equal to the SID of the current schema node minus the SID of the &#8216;action&#8217;.</li>
<li>In the case of an &#8216;notification content&#8217;, deltas are equal to the SID of the current schema node minus the SID of the &#8216;notification&#8217;.</li>
</ul>
<p id="rfc.section.4.2.1.p.5">This example assumes that the Media Type used to carry this container consists of a CBOR map composed of the data node SID and data node encoding. This root CBOR map is not part of the present encoding rules and is not compulsory.</p>
<p id="rfc.section.4.2.1.p.6">CBOR diagnostic notation:</p>
<pre>
{
  1720 : {                              / system-state /
    +1 : {                              / clock  (SID 1721) /
      +2 : "2015-10-02T14:47:24Z-05:00",/ current-datetime (SID 1723) /
      +1 : "2015-09-15T09:12:58Z-05:00" / boot-datetime (SID 1722) /
    }
  }
}
</pre>
<p id="rfc.section.4.2.1.p.7">CBOR encoding:</p>
<pre>
A1                                      # map(1)
   19 06B8                              # unsigned(1720)
   A1                                   # map(1)
      01                                # unsigned(1)
      A2                                # map(2)
         02                             # unsigned(2)
         78 1A                          # text(26)
            323031352D31302D30325431343A34373A32345A2D30353A3030
         01                             # unsigned(1)
         78 1A                          # text(26)
            323031352D30392D31355430393A31323A35385A2D30353A3030
</pre>
<h1 id="rfc.section.4.2.2">
<a href="#rfc.section.4.2.2">4.2.2.</a> <a href="#container-with-name" id="container-with-name">Names as keys</a>
</h1>
<p id="rfc.section.4.2.2.p.1">CBOR map keys implemented using names MUST be encoded using a CBOR text string data item (major type 3). A namespace-qualified name MUST be used each time the namespace of a schema node and its parent differ. In all other cases, the simple form of the name MUST be used. Names and namespaces are defined in <a href="#RFC7951" class="xref">[RFC7951]</a> section 4.</p>
<p id="rfc.section.4.2.2.p.2">The following example shows the encoding of a &#8216;system&#8217; container instance using names.</p>
<p id="rfc.section.4.2.2.p.3">Definition example from <a href="#RFC7317" class="xref">[RFC7317]</a>:</p>
<pre>
typedef date-and-time {
  type string {
    pattern '\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d+)?(Z|[\+\-]
             \d{2}:\d{2})';
  }
}
   
container system-state {

  container clock {
    leaf current-datetime {
      type date-and-time;
    }

    leaf boot-datetime {
      type date-and-time;
    }
  }
}
</pre>
<p id="rfc.section.4.2.2.p.4">This example assumes that the Media Type used to carry this container consists of a CBOR map composed of the data node namespace qualified name and data node encoding. This root CBOR map is not part of the present encoding rules and is not compulsory.</p>
<p id="rfc.section.4.2.2.p.5">CBOR diagnostic notation:</p>
<pre>
{
  "ietf-system:system-state" : {
    "ietf-system:clock" : {
      "current-datetime" : "2015-10-02T14:47:24Z-05:00",
      "boot-datetime" : "2015-09-15T09:12:58Z-05:00"
    }
  }
}
</pre>
<p id="rfc.section.4.2.2.p.6">CBOR encoding:</p>
<pre>
A1                                      # map(1)
   78 18                                # text(24)
      696574662D73797374656D3A73797374656D2D7374617465 
   A1                                   # map(1)
      71                                # text(17)
         696574662D73797374656D3A636C6F636B
      A2                                # map(2)
         70                             # text(16)
            63757272656E742D6461746574696D65
         78 1A                          # text(26)
            323031352D31302D30325431343A34373A32345A2D30353A3030
         6D                             # text(13)
            626F6F742D6461746574696D65
         78 1A                          # text(26)
            323031352D30392D31355430393A31323A35385A2D30353A3030
</pre>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#leaf-list" id="leaf-list">The &#8216;leaf-list&#8217;</a>
</h1>
<p id="rfc.section.4.3.p.1">A leaf-list MUST be encoded using a CBOR array data item (major type 4). Each entry of this array MUST be encoded accordingly to its datatype using one of the encoding rules specified in <a href="#data-types-mapping" class="xref">Section 6</a>.</p>
<p id="rfc.section.4.3.p.2">The following example shows the encoding of the &#8216;search&#8217; leaf-list instance containing two entries, &#8220;ietf.org&#8221; and &#8220;ieee.org&#8221;.</p>
<p id="rfc.section.4.3.p.3">Definition example <a href="#RFC7317" class="xref">[RFC7317]</a>:</p>
<pre>
typedef domain-name {
  type string {
    length "1..253";
    pattern '((([a-zA-Z0-9_]([a-zA-Z0-9\-_]){0,61})?[a-zA-Z0-9].)
             *([a-zA-Z0-9_]([a-zA-Z0-9\-_]){0,61})?[a-zA-Z0-9]\.?
             )|\.';
  }
}

leaf-list search {
  type domain-name;
  ordered-by user;
}
</pre>
<p id="rfc.section.4.3.p.4">CBOR diagnostic notation: [ &#8220;ietf.org&#8221;, &#8220;ieee.org&#8221; ]</p>
<p id="rfc.section.4.3.p.5">CBOR encoding: 82  68 696574662E6F7267  68 696565652E6F7267</p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> <a href="#list" id="list">The &#8216;list&#8217; and &#8216;list&#8217; instance(s)</a>
</h1>
<p id="rfc.section.4.4.p.1">A list or a subset of a list MUST be encoded using a CBOR array data item (major type 4). Each list instance within this CBOR array is encoded using a CBOR map data item (major type 5) based on the encoding rules of a collection as defined in <a href="#container" class="xref">Section 4.2</a>.</p>
<p id="rfc.section.4.4.p.2">It is important to note that this encoding rule also apply to a single &#8216;list&#8217; instance.</p>
<p id="rfc.section.4.4.p.3">The following examples show the encoding of a &#8216;server&#8217; list using SIDs or names.</p>
<p id="rfc.section.4.4.p.4">Definition example from <a href="#RFC7317" class="xref">[RFC7317]</a>:</p>
<pre>
list server {
  key name;

  leaf name {
    type string;
  }
  choice transport {
    case udp {
      container udp {
        leaf address {
          type host;
          mandatory true;
        }
        leaf port {
          type port-number;
        }
      }
    }
  }
  leaf association-type {
    type enumeration {
      enum server;
      enum peer;
      enum pool;
    }
    default server;
  }
  leaf iburst {
    type boolean;
    default false;
  }
  leaf prefer {
    type boolean;
    default false;
  }
}
</pre>
<h1 id="rfc.section.4.4.1">
<a href="#rfc.section.4.4.1">4.4.1.</a> <a href="#list-with-sid" id="list-with-sid">SIDs as keys</a>
</h1>
<p id="rfc.section.4.4.1.p.1">The encoding rules of each &#8216;list&#8217; instance are defined in <a href="#container-with-sid" class="xref">Section 4.2.1</a>. Deltas of list members are equal to the SID of the current schema node minus the SID of the &#8216;list&#8217;.</p>
<p id="rfc.section.4.4.1.p.2">This example assumes that the Media Type used to carry this list consists of a CBOR map composed of the data node SID and data node encoding. This root CBOR map is not part of the present encoding rules and is not compulsory.</p>
<p id="rfc.section.4.4.1.p.3">CBOR diagnostic notation:</p>
<pre>
{
  1756 : [                      / server (SID 1756) /
    {
      +3 : "NRC TIC server",    / name (SID 1759) /
      +5 : {                    / udp (SID 1761) /
        +1 : "tic.nrc.ca",      / address (SID 1762) /
        +2 : 123                / port (SID 1763) /
      },
      +1 : 0,                   / association-type (SID 1757) /
      +2 : false,               / iburst (SID 1758) /
      +4 : true                 / prefer (SID 1760) /
    },
    {
      +3 : "NRC TAC server",    / name (SID 1759) /
      +5 : {                    / udp (SID 1761) /
        +1 : "tac.nrc.ca"       / address (SID 1762) /
      }
    }
  ]
}
</pre>
<p id="rfc.section.4.4.1.p.4">CBOR encoding:</p>
<pre>
A1                                      # map(1)
   19 06DC                              # unsigned(1756)
   82                                   # array(2)
      A5                                # map(5)
         03                             # unsigned(3)
         6E                             # text(14)
            4E52432054494320736572766572 # "NRC TIC server"
         05                             # unsigned(5)
         A2                             # map(2)
            01                          # unsigned(1)
            6A                          # text(10)
               7469632E6E72632E6361     # "tic.nrc.ca"
            02                          # unsigned(2)
            18 7B                       # unsigned(123)
         01                             # unsigned(1)
         00                             # unsigned(0)
         02                             # unsigned(2)
         F4                             # primitive(20)
         04                             # unsigned(4)
         F5                             # primitive(21)
      A2                                # map(2)
         03                             # unsigned(3)
         6E                             # text(14)
            4E52432054414320736572766572 # "NRC TAC server"
         05                             # unsigned(5)
         A1                             # map(1)
            01                          # unsigned(1)
            6A                          # text(10)
               7461632E6E72632E6361     # "tac.nrc.ca"
</pre>
<h1 id="rfc.section.4.4.2">
<a href="#rfc.section.4.4.2">4.4.2.</a> <a href="#names-as-keys" id="names-as-keys">Names as keys</a>
</h1>
<p id="rfc.section.4.4.2.p.1">The encoding rules of each &#8216;list&#8217; instance are defined in <a href="#container-with-name" class="xref">Section 4.2.2</a>.</p>
<p id="rfc.section.4.4.2.p.2">This example assumes that the Media Type used to carry this container consists of a CBOR map composed of the data node namespace qualified name and data node encoding. This root CBOR map is not part of the present encoding rules and is not compulsory.</p>
<p id="rfc.section.4.4.2.p.3">CBOR diagnostic notation:</p>
<pre>
{
  "ietf-system:server" : [
    {
      "name" : "NRC TIC server",
      "udp" : {
        "address" : "tic.nrc.ca",
        "port" : 123
      },
      "association-type" : 0,
      "iburst" : false,
      "prefer" : true
    },
    {
      "name" : "NRC TAC server",
      "udp" : {
        "address" : "tac.nrc.ca"
      }
    }
  ]
}
</pre>
<p id="rfc.section.4.4.2.p.4">CBOR encoding:</p>
<pre>
A1                                      # map(1)
   72                                   # text(18)
      696574662D73797374656D3A736572766572
   82                                   # array(2)
      A5                                # map(5)
         64                             # text(4)
            6E616D65                    # "name"
         6E                             # text(14)
            4E52432054494320736572766572
         63                             # text(3)
            756470                      # "udp"
         A2                             # map(2)
            67                          # text(7)
               61646472657373           # "address"
            6A                          # text(10)
               7469632E6E72632E6361     # "tic.nrc.ca"
            64                          # text(4)
               706F7274                 # "port"
            18 7B                       # unsigned(123)
         70                             # text(16)
            6173736F63696174696F6E2D74797065
         00                             # unsigned(0)
         66                             # text(6)
            696275727374                # "iburst"
         F4                             # primitive(20)
         66                             # text(6)
            707265666572                # "prefer"
         F5                             # primitive(21)
      A2                                # map(2)
         64                             # text(4)
            6E616D65                    # "name"
         6E                             # text(14)
            4E52432054414320736572766572
         63                             # text(3)
            756470                      # "udp"
         A1                             # map(1)
            67                          # text(7)
               61646472657373           # "address"
            6A                          # text(10)
               7461632E6E72632E6361     # "tac.nrc.ca"
</pre>
<h1 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> <a href="#the-anydata" id="the-anydata">The &#8216;anydata&#8217;</a>
</h1>
<p id="rfc.section.4.5.p.1">An anydata serves as a container for an arbitrary set of schema nodes that otherwise appear as normal YANG-modeled data. An anydata instance is encoded using the same rules as a container, i.e., CBOR map. The requirement that anydata content can be modeled by YANG implies the following:</p>
<p></p>

<ul>
<li>CBOR map keys of any inner schema nodes MUST be set to valid deltas or names.</li>
<li>The CBOR array MUST contain either unique scalar values (as a leaf-list, see <a href="#leaf-list" class="xref">Section 4.3</a>), or maps (as a list, see <a href="#list" class="xref">Section 4.4</a>).</li>
<li>CBOR map values MUST follow the encoding rules of one of the datatypes listed in <a href="#instance-encoding" class="xref">Section 4</a>.</li>
</ul>
<p id="rfc.section.4.5.p.3">The following example shows a possible use of an anydata. In this example, an anydata is used to define a schema node containing a notification event, this schema node can be part of a YANG list to create an event logger.</p>
<p id="rfc.section.4.5.p.4">Definition example:</p>
<pre>
module event-log {
  ...
  anydata last-event;                # SID 60123
</pre>
<p id="rfc.section.4.5.p.5">This example also assumes the assistance of the following notification.</p>
<pre>
module example-port {
  ...

  notification example-port-fault {  # SID 60200
    leaf port-name {                 # SID 60201
      type string;
    }
    leaf port-fault {                # SID 60202
      type string;
    }
  }
}
</pre>
<p id="rfc.section.4.5.p.6">This example assumes that the Media Type used to carry this anydata consists of a CBOR map composed of the data node SID and data node encoding. This root CBOR map is not part of the present encoding rules and is not compulsory.</p>
<p id="rfc.section.4.5.p.7">CBOR diagnostic notation:</p>
<pre>
{
  60123 : {                   / last-event (SID=60123) /
    +77 : {                   / event (SID=60200) /
      +1 : "0/4/21",          / port-name (SID=60201) /
      +2 : "Open pin 2"       / port-fault (SID=60202) /
    }
  }
}
</pre>
<p id="rfc.section.4.5.p.8">CBOR encoding:</p>
<pre>
A1                               # map(1)
   19 EADB                       # unsigned(60123)
   A1                            # map(1)
      18 4D                      # unsigned(77)
      A2                         # map(2)
         18 4E                   # unsigned(78)
         66                      # text(6)
            302F342F3231         # "0/4/21"
         18 4F                   # unsigned(79)
         6A                      # text(10)
            4F70656E2070696E2032 # "Open pin 2"

</pre>
<p id="rfc.section.4.5.p.9">In some implementations, it might be simpler to use the absolute SID tag encoding for the anydata root element. The resulting encoding is as follow:</p>
<pre>
{
  60123 : {                   / last-event (SID=60123) /
    99(60200) : {             / event (SID=60123) /
      +1 : "0/4/21",          / port-name (SID=60201) /
      +2 : "Open pin 2"       / port-fault (SID=60202) /
    }
  }
}
</pre>
<p id="rfc.section.4.5.p.10">// RFC Ed.: replace 99 by the allocated CBOR tag.</p>
<h1 id="rfc.section.4.6">
<a href="#rfc.section.4.6">4.6.</a> <a href="#the-anyxml" id="the-anyxml">The &#8216;anyxml&#8217;</a>
</h1>
<p id="rfc.section.4.6.p.1">An anyxml schema node is used to serialize an arbitrary CBOR content, i.e., its value can be any CBOR binary object. anyxml value MAY contain CBOR data items tagged with one of the tag listed in <a href="#tag-registry" class="xref">Section 8.1</a>, these tags shall be supported.</p>
<p id="rfc.section.4.6.p.2">The following example shows a valid CBOR encoded instance consisting of a CBOR array containing the CBOR simple values &#8216;true&#8217;, &#8216;null&#8217; and &#8216;true&#8217;.</p>
<p id="rfc.section.4.6.p.3">Definition example from <a href="#RFC7951" class="xref">[RFC7951]</a>:</p>
<pre>
anyxml bar;
</pre>
<p id="rfc.section.4.6.p.4">Note: This example assumes that the Media Type used to carry this anyxml consists of a CBOR map composed of the data node SID and data node encoding. This root CBOR map is not part of the present encoding rules and is not compulsory.</p>
<p id="rfc.section.4.6.p.5">CBOR diagnostic notation:</p>
<pre>
{
  60000 : [true, null, true]   / bar (SID 60000) /
}
</pre>
<p id="rfc.section.4.6.p.6">CBOR encoding:</p>
<pre>
A1         # map(1)
   19 EA60 # unsigned(60000)
   83      # array(3)
      F5   # primitive(21)
      F6   # primitive(22)
      F5   # primitive(21)
</pre>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#encoding-of-yang-data-templates" id="encoding-of-yang-data-templates">Encoding of YANG data templates</a>
</h1>
<p id="rfc.section.5.p.1">YANG data templates are data structures defined in YANG but not intended to be implemented as part of a datastore. YANG data templates are defined using the &#8216;yang-data&#8217; extension as described by RFC 8040.</p>
<p id="rfc.section.5.p.2">YANG data templates SHOULD be encoded using the encoding rules of a collection as defined in <a href="#container" class="xref">Section 4.2</a>.</p>
<p id="rfc.section.5.p.3">Just like YANG containers, YANG data templates can be encoded using either SIDs or names.</p>
<p id="rfc.section.5.p.4">Definition example from <a href="#I-D.ietf-core-comi" class="xref">[I-D.ietf-core-comi]</a>:</p>
<pre>
import ietf-restconf {
  prefix rc;
}

rc:yang-data yang-errors {
  container error {
    leaf error-tag {
      type identityref {
        base error-tag;
      }
    }
    leaf error-app-tag {
      type identityref {
        base error-app-tag;
      }
    }   
    leaf error-data-node {
      type instance-identifier;
    }
    leaf error-message {
      type string;
    }
  }
}
</pre>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#sids-as-keys" id="sids-as-keys">SIDs as keys</a>
</h1>
<p id="rfc.section.5.1.p.1">YANG template encoded using SIDs are carried in a CBOR map containing a single item pair. The key of this item is set to the SID assigned to the YANG template container, the value is set the CBOR encoding of this container as defined in <a href="#container" class="xref">Section 4.2</a>.</p>
<p id="rfc.section.5.1.p.2">This example shows a serialization example of the yang-errors template as defined in <a href="#I-D.ietf-core-comi" class="xref">[I-D.ietf-core-comi]</a> using SIDs as defined in <a href="#sid" class="xref">Section 3.2</a>.</p>
<p id="rfc.section.5.1.p.3">CBOR diagnostic notation:</p>
<pre>
{
  1024 : {                      / error  (SID 1024) /
    +4 : 1011,                  / error-tag (SID 1028) /
                                / = invalid-value (SID 1011) /
    +1 : 1018,                  / error-app-tag (SID 1025) /
                                / = not-in-range (SID 1018) /
    +2 : 1740,                  / error-data-node (SID 1026) /
                                / = timezone-utc-offset (SID 1740) /
    +3 : "Maximum exceeded"     / error-message (SID 1027) /
      }
}
</pre>
<p id="rfc.section.5.1.p.4">CBOR encoding:</p>
<pre>
A1                                      # map(1)
   19 0400                              # unsigned(1024)
   A4                                   # map(4)
      04                                # unsigned(4)
      19 03F3                           # unsigned(1011)
      01                                # unsigned(1)
      19 03FA                           # unsigned(1018)
      02                                # unsigned(2)
      19 06CC                           # unsigned(1740)
      03                                # unsigned(3)
      70                                # text(16)
         4D6178696D756D206578636565646564
</pre>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#names-as-keys-1" id="names-as-keys-1">Names as keys</a>
</h1>
<p id="rfc.section.5.2.p.1">YANG template encoded using names are carried in a CBOR map containing a single item pair. The key of this item is set to the namespace qualified name of the YANG template container, the value is set the CBOR encoding of this container as defined in <a href="#name" class="xref">Section 3.3</a>.</p>
<p id="rfc.section.5.2.p.2">This example shows a serialization example of the yang-errors template as defined in <a href="#I-D.ietf-core-comi" class="xref">[I-D.ietf-core-comi]</a> using names as defined <a href="#name" class="xref">Section 3.3</a>.</p>
<p id="rfc.section.5.2.p.3">CBOR diagnostic notation:</p>
<pre>
{
  "ietf-comi:error" : {
    "error-tag" : "invalid-value",
    "error-app-tag" : "not-in-range",
    "error-data-node" : "timezone-utc-offset",
    "error-message" : "Maximum exceeded"
  }
}
</pre>
<p id="rfc.section.5.2.p.4">CBOR encoding:</p>
<pre>
A1                                      # map(1)
   6F                                   # text(15)
      696574662D636F6D693A6572726F72    # "ietf-comi:error"
   A4                                   # map(4)
      69                                # text(9)
         6572726F722D746167             # "error-tag"
      6D                                # text(13)
         696E76616C69642D76616C7565     # "invalid-value"
      6D                                # text(13)
         6572726F722D6170702D746167     # "error-app-tag"
      6C                                # text(12)
         6E6F742D696E2D72616E6765       # "not-in-range"
      6F                                # text(15)
         6572726F722D646174612D6E6F6465 # "error-data-node"
      73                                # text(19)
         74696D657A6F6E652D7574632D6F6666736574 # "timezone-utc-offset"
      6D                                # text(13)
         6572726F722D6D657373616765     # "error-message"
      70                                # text(16)
         4D6178696D756D206578636565646564
</pre>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#data-types-mapping" id="data-types-mapping">Representing YANG Data Types in CBOR</a>
</h1>
<p id="rfc.section.6.p.1">The CBOR encoding of an instance of a leaf or leaf-list schema node depends on the built-in type of that schema node. The following sub-section defined the CBOR encoding of each built-in type supported by YANG as listed in <a href="#RFC7950" class="xref">[RFC7950]</a> section 4.2.4. Each subsection shows an example value assigned to a schema node instance of the discussed built-in type.</p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#the-unsigned-integer-types" id="the-unsigned-integer-types">The unsigned integer Types</a>
</h1>
<p id="rfc.section.6.1.p.1">Leafs of type uint8, uint16, uint32 and uint64 MUST be encoded using a CBOR unsigned integer data item (major type 0).</p>
<p id="rfc.section.6.1.p.2">The following example shows the encoding of a &#8216;mtu&#8217; leaf instance set to 1280 bytes.</p>
<p id="rfc.section.6.1.p.3">Definition example from <a href="#RFC7277" class="xref">[RFC7277]</a>:</p>
<pre>
leaf mtu {
  type uint16 {
    range "68..max";
  }
}
</pre>
<p id="rfc.section.6.1.p.4">CBOR diagnostic notation: 1280</p>
<p id="rfc.section.6.1.p.5">CBOR encoding: 19 0500</p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> <a href="#the-integer-types" id="the-integer-types">The integer Types</a>
</h1>
<p id="rfc.section.6.2.p.1">Leafs of type int8, int16, int32 and int64 MUST be encoded using either CBOR unsigned integer (major type 0) or CBOR negative integer (major type 1), depending on the actual value.</p>
<p id="rfc.section.6.2.p.2">The following example shows the encoding of a &#8216;timezone-utc-offset&#8217; leaf instance set to -300 minutes.</p>
<p id="rfc.section.6.2.p.3">Definition example from <a href="#RFC7317" class="xref">[RFC7317]</a>:</p>
<pre>
leaf timezone-utc-offset {
  type int16 {
    range "-1500 .. 1500";
  }
}
</pre>
<p id="rfc.section.6.2.p.4">CBOR diagnostic notation: -300</p>
<p id="rfc.section.6.2.p.5">CBOR encoding: 39 012B</p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> <a href="#the-decimal64-type" id="the-decimal64-type">The &#8216;decimal64&#8217; Type</a>
</h1>
<p id="rfc.section.6.3.p.1">Leafs of type decimal64 MUST be encoded using a decimal fraction as defined in <a href="#RFC7049" class="xref">[RFC7049]</a> section 2.4.3.</p>
<p id="rfc.section.6.3.p.2">The following example shows the encoding of a &#8216;my-decimal&#8217; leaf instance set to 2.57.</p>
<p id="rfc.section.6.3.p.3">Definition example from <a href="#RFC7317" class="xref">[RFC7317]</a>:</p>
<pre>
leaf my-decimal {
  type decimal64 {
    fraction-digits 2;
    range "1 .. 3.14 | 10 | 20..max";
  }
}
</pre>
<p id="rfc.section.6.3.p.4">CBOR diagnostic notation: 4([-2, 257])</p>
<p id="rfc.section.6.3.p.5">CBOR encoding: C4 82 21 19 0101</p>
<h1 id="rfc.section.6.4">
<a href="#rfc.section.6.4">6.4.</a> <a href="#the-string-type" id="the-string-type">The &#8216;string&#8217; Type</a>
</h1>
<p id="rfc.section.6.4.p.1">Leafs of type string MUST be encoded using a CBOR text string data item (major type 3).</p>
<p id="rfc.section.6.4.p.2">The following example shows the encoding of a &#8216;name&#8217; leaf instance set to &#8220;eth0&#8221;.</p>
<p id="rfc.section.6.4.p.3">Definition example from <a href="#RFC7223" class="xref">[RFC7223]</a>:</p>
<pre>
leaf name {
  type string;
}
</pre>
<p id="rfc.section.6.4.p.4">CBOR diagnostic notation: &#8220;eth0&#8221;</p>
<p id="rfc.section.6.4.p.5">CBOR encoding: 64 65746830</p>
<h1 id="rfc.section.6.5">
<a href="#rfc.section.6.5">6.5.</a> <a href="#the-boolean-type" id="the-boolean-type">The &#8216;boolean&#8217; Type</a>
</h1>
<p id="rfc.section.6.5.p.1">Leafs of type boolean MUST be encoded using a CBOR simple value &#8216;true&#8217; (major type 7, additional information 21) or &#8216;false&#8217; (major type 7, additional information 20).</p>
<p id="rfc.section.6.5.p.2">The following example shows the encoding of an &#8216;enabled&#8217; leaf instance set to &#8216;true&#8217;.</p>
<p id="rfc.section.6.5.p.3">Definition example from <a href="#RFC7317" class="xref">[RFC7317]</a>:</p>
<pre>
leaf enabled {
  type boolean;
}
</pre>
<p id="rfc.section.6.5.p.4">CBOR diagnostic notation: true</p>
<p id="rfc.section.6.5.p.5">CBOR encoding: F5</p>
<h1 id="rfc.section.6.6">
<a href="#rfc.section.6.6">6.6.</a> <a href="#enumeration" id="enumeration">The &#8216;enumeration&#8217; Type</a>
</h1>
<p id="rfc.section.6.6.p.1">Leafs of type enumeration MUST be encoded using a CBOR unsigned integer (major type 0) or CBOR negative integer (major type 1), depending on the actual value. Enumeration values are either explicitly assigned using the YANG statement &#8216;value&#8217; or automatically assigned based on the algorithm defined in <a href="#RFC7950" class="xref">[RFC7950]</a> section 9.6.4.2.</p>
<p id="rfc.section.6.6.p.2">The following example shows the encoding of an &#8216;oper-status&#8217; leaf instance set to &#8216;testing&#8217;.</p>
<p id="rfc.section.6.6.p.3">Definition example from <a href="#RFC7317" class="xref">[RFC7317]</a>:</p>
<pre>
leaf oper-status {
  type enumeration {
    enum up { value 1; }
    enum down { value 2; }
    enum testing { value 3; }
    enum unknown { value 4; }
    enum dormant { value 5; }
    enum not-present { value 6; }
    enum lower-layer-down { value 7; }
  }
}
</pre>
<p id="rfc.section.6.6.p.4">CBOR diagnostic notation: 3</p>
<p id="rfc.section.6.6.p.5">CBOR encoding: 03</p>
<p id="rfc.section.6.6.p.6">To avoid overlap of &#8216;value&#8217; defined in different &#8216;enumeration&#8217; statements, &#8216;enumeration&#8217; defined in a Leafs of type &#8216;union&#8217; MUST be encoded using a CBOR text string data item (major type 3) and MUST contain one of the names assigned by &#8216;enum&#8217; statements in YANG. The encoding MUST be prefixed with the enumeration CBOR tag as specified in <a href="#tag-registry" class="xref">Section 8.1</a>.</p>
<p id="rfc.section.6.6.p.7">Definition example from <a href="#RFC7950" class="xref">[RFC7950]</a>:</p>
<pre>
type union {
  type int32;
  type enumeration {
    enum "unbounded";
  }
}
</pre>
<p id="rfc.section.6.6.p.8">CBOR diagnostic notation: 99(&#8220;unbounded&#8221;)</p>
<p id="rfc.section.6.6.p.9">CBOR encoding: D8 63 69 756E626F756E646564</p>
<p id="rfc.section.6.6.p.10">// RFC Ed.: update 99 and D8 63 with the enumerator CBOR tag allocated.</p>
<h1 id="rfc.section.6.7">
<a href="#rfc.section.6.7">6.7.</a> <a href="#bits" id="bits">The &#8216;bits&#8217; Type</a>
</h1>
<p id="rfc.section.6.7.p.1">Leafs of type bits MUST be encoded using a CBOR byte string data item (major type 2). Bits position are either explicitly assigned using the YANG statement &#8216;position&#8217; or automatically assigned based on the algorithm defined in <a href="#RFC7950" class="xref">[RFC7950]</a> section 9.7.4.2.</p>
<p id="rfc.section.6.7.p.2">Bits position 0 to 7 are assigned to the first byte within the byte string, bits 8 to 15 to the second byte, and subsequent bytes are assigned similarly. Within each byte, bits are assigned from least to most significant.</p>
<p id="rfc.section.6.7.p.3">The following example shows the encoding of an &#8216;alarm-state&#8217; leaf instance with the &#8216;under-repair&#8217; and &#8216;critical&#8217; flags set.</p>
<p id="rfc.section.6.7.p.4">Definition example from <a href="#RFC8348" class="xref">[RFC8348]</a>:</p>
<pre>
typedef alarm-state {
  type bits {
    bit unknown;
    bit under-repair;
    bit critical;
    bit major;
    bit minor;
    bit warning;
    bit indeterminate;
  }
}

leaf alarm-state {
  type alarm-state;
}
</pre>
<p id="rfc.section.6.7.p.5">CBOR diagnostic notation: h&#8217;06&#8217;</p>
<p id="rfc.section.6.7.p.6">CBOR encoding: 41 06</p>
<p id="rfc.section.6.7.p.7">To avoid overlap of &#8216;bit&#8217; defined in different &#8216;bits&#8217; statement, &#8216;bits&#8217; defined in a Leafs of type &#8216;union&#8217; MUST be encoded using a CBOR text string data item (major type 3) and MUST contain a space-separated sequence of names of &#8216;bit&#8217; that are set. The encoding MUST be prefixed with the bits CBOR tag as specified in <a href="#tag-registry" class="xref">Section 8.1</a>.</p>
<p id="rfc.section.6.7.p.8">The following example shows the encoding of an &#8216;alarm-state&#8217; leaf instance defined using a union type with the &#8216;under-repair&#8217; and &#8216;critical&#8217; flags set.</p>
<p id="rfc.section.6.7.p.9">Definition example:</p>
<pre>
leaf alarm-state {
  type type union {
    type alarm-state;
    type empty;
  }
}
</pre>
<p id="rfc.section.6.7.p.10">CBOR diagnostic notation: 99(&#8220;under-repair critical&#8221;)</p>
<p id="rfc.section.6.7.p.11">CBOR encoding: D8 63 75 756E6465722D72657061697220637269746963616C</p>
<p id="rfc.section.6.7.p.12">// RFC Ed.: update 99 and D8 63 with the bits CBOR tag allocated.</p>
<h1 id="rfc.section.6.8">
<a href="#rfc.section.6.8">6.8.</a> <a href="#the-binary-type" id="the-binary-type">The &#8216;binary&#8217; Type</a>
</h1>
<p id="rfc.section.6.8.p.1">Leafs of type binary MUST be encoded using a CBOR byte string data item (major type 2).</p>
<p id="rfc.section.6.8.p.2">The following example shows the encoding of an &#8216;aes128-key&#8217; leaf instance set to 0x1f1ce6a3f42660d888d92a4d8030476e.</p>
<p id="rfc.section.6.8.p.3">Definition example:</p>
<pre>
leaf aes128-key {
  type binary {
    length 16;
  }
}
</pre>
<p id="rfc.section.6.8.p.4">CBOR diagnostic notation: h&#8217;1F1CE6A3F42660D888D92A4D8030476E&#8217;</p>
<p id="rfc.section.6.8.p.5">CBOR encoding: 50 1F1CE6A3F42660D888D92A4D8030476E</p>
<h1 id="rfc.section.6.9">
<a href="#rfc.section.6.9">6.9.</a> <a href="#the-leafref-type" id="the-leafref-type">The &#8216;leafref&#8217; Type</a>
</h1>
<p id="rfc.section.6.9.p.1">Leafs of type leafref MUST be encoded using the rules of the schema node referenced by the &#8216;path&#8217; YANG statement.</p>
<p id="rfc.section.6.9.p.2">The following example shows the encoding of an &#8216;interface-state-ref&#8217; leaf instance set to &#8220;eth1&#8221;.</p>
<p id="rfc.section.6.9.p.3">Definition example from <a href="#RFC7223" class="xref">[RFC7223]</a>:</p>
<pre>
typedef interface-state-ref {
  type leafref {
    path "/interfaces-state/interface/name";
  }
}

container interfaces-state {
  list interface {
    key "name";
    leaf name {
      type string;
    }
    leaf-list higher-layer-if {
      type interface-state-ref;
    }
  }
}
</pre>
<p id="rfc.section.6.9.p.4">CBOR diagnostic notation: &#8220;eth1&#8221;</p>
<p id="rfc.section.6.9.p.5">CBOR encoding: 64 65746831</p>
<h1 id="rfc.section.6.10">
<a href="#rfc.section.6.10">6.10.</a> <a href="#the-identityref-type" id="the-identityref-type">The &#8216;identityref&#8217; Type</a>
</h1>
<p id="rfc.section.6.10.p.1">This specification supports two approaches for encoding identityref, a YANG Schema Item iDentifier (SID) as defined in <a href="#sid" class="xref">Section 3.2</a> or a name as defined in <a href="#RFC7951" class="xref">[RFC7951]</a> section 6.8.</p>
<h1 id="rfc.section.6.10.1">
<a href="#rfc.section.6.10.1">6.10.1.</a> <a href="#identityref-with-sid" id="identityref-with-sid">SIDs as identityref</a>
</h1>
<p id="rfc.section.6.10.1.p.1">When schema nodes of type identityref are implemented using SIDs, they MUST be encoded using a CBOR unsigned integer data item (major type 0). (Note that no delta mechanism is employed for SIDs as identityref.)</p>
<p id="rfc.section.6.10.1.p.2">The following example shows the encoding of a &#8216;type&#8217; leaf instance set to the value &#8216;iana-if-type:ethernetCsmacd&#8217; (SID 1880).</p>
<p id="rfc.section.6.10.1.p.3">Definition example from <a href="#RFC7317" class="xref">[RFC7317]</a>:</p>
<pre>
identity interface-type {
}

identity iana-interface-type {
  base interface-type;
}

identity ethernetCsmacd {
  base iana-interface-type;
}

leaf type {
  type identityref {
    base interface-type;
  }
}
</pre>
<p id="rfc.section.6.10.1.p.4">CBOR diagnostic notation: 1880</p>
<p id="rfc.section.6.10.1.p.5">CBOR encoding: 19 0758</p>
<h1 id="rfc.section.6.10.2">
<a href="#rfc.section.6.10.2">6.10.2.</a> <a href="#name-as-identityref" id="name-as-identityref">Name as identityref</a>
</h1>
<p id="rfc.section.6.10.2.p.1">Alternatively, an identityref MAY be encoded using a name as defined in <a href="#name" class="xref">Section 3.3</a>.  When names are used, identityref MUST be encoded using a CBOR text string data item (major type 3). If the identity is defined in different module than the leaf node containing the identityref data node, the namespace qualified form MUST be used. Otherwise, both the simple and namespace qualified forms are permitted. Names and namespaces are defined in <a href="#name" class="xref">Section 3.3</a>.</p>
<p id="rfc.section.6.10.2.p.2">The following example shows the encoding of the identity &#8216;iana-if-type:ethernetCsmacd&#8217; using its namespace qualified name. This example is described in <a href="#identityref-with-sid" class="xref">Section 6.10.1</a>.</p>
<p id="rfc.section.6.10.2.p.3">CBOR diagnostic notation: &#8220;iana-if-type:ethernetCsmacd&#8221;</p>
<p id="rfc.section.6.10.2.p.4">CBOR encoding: 78 1b 69616E612D69662D747970653A65746865726E657443736D616364</p>
<h1 id="rfc.section.6.11">
<a href="#rfc.section.6.11">6.11.</a> <a href="#the-empty-type" id="the-empty-type">The &#8216;empty&#8217; Type</a>
</h1>
<p id="rfc.section.6.11.p.1">Leafs of type empty MUST be encoded using the CBOR null value (major type 7, additional information 22).</p>
<p id="rfc.section.6.11.p.2">The following example shows the encoding of a &#8216;is-router&#8217; leaf instance when present.</p>
<p id="rfc.section.6.11.p.3">Definition example from <a href="#RFC7277" class="xref">[RFC7277]</a>:</p>
<pre>
leaf is-router {
  type empty;
}
</pre>
<p id="rfc.section.6.11.p.4">CBOR diagnostic notation: null</p>
<p id="rfc.section.6.11.p.5">CBOR encoding: F6</p>
<h1 id="rfc.section.6.12">
<a href="#rfc.section.6.12">6.12.</a> <a href="#union" id="union">The &#8216;union&#8217; Type</a>
</h1>
<p id="rfc.section.6.12.p.1">Leafs of type union MUST be encoded using the rules associated with one of the types listed.  When used in a union, the following YANG datatypes are prefixed by CBOR tag to avoid confusion between different YANG datatypes encoded using the same CBOR major type.</p>
<p></p>

<ul>
<li>bits</li>
<li>enumeration</li>
<li>identityref</li>
<li>instance-identifier</li>
</ul>
<p id="rfc.section.6.12.p.3">See <a href="#tag-registry" class="xref">Section 8.1</a> for the assigned value of these CBOR tags.</p>
<p id="rfc.section.6.12.p.4">As mentioned in <a href="#enumeration" class="xref">Section 6.6</a> and in <a href="#bits" class="xref">Section 6.7</a>, &#8216;enumeration&#8217; and &#8216;bits&#8217; are encoded as CBOR text string data item (major type 3) when defined within a &#8216;union&#8217; type.</p>
<p id="rfc.section.6.12.p.5">The following example shows the encoding of an &#8216;ip-address&#8217; leaf instance when set to &#8220;2001:db8:a0b:12f0::1&#8221;.</p>
<p id="rfc.section.6.12.p.6">Definition example from <a href="#RFC7317" class="xref">[RFC7317]</a>:</p>
<pre>
typedef ipv4-address {
  type string {
  pattern '(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}
           ([0-9][1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(%[\p{N}
           \p{L}]+)?';
  }
}

typedef ipv6-address {
  type string {
    pattern '((:|[0-9a-fA-F]{0,4}):)([0-9a-fA-F]{0,4}:){0,5}((([0-9a
             -fA-F]{0,4}:)?(:|[0-9a-fA-F]{0,4}))|(((25[0-5]|2[0-4][0
             -9]|[01]?[0-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0
             -9]?[0-9])))(%[\p{N}\p{L}]+)?';
    pattern '(([^:]+:){6}(([^:]+:[^:]+)|(.*\..*)))|((([^:]+:)*[^:]+)
             ?::(([^:]+:)*[^:]+)?)(%.+)?';
  }
}

typedef ip-address {
  type union {
    type ipv4-address;
    type ipv6-address;
  }
}

leaf address {
  type inet:ip-address;
}
</pre>
<p id="rfc.section.6.12.p.7">CBOR diagnostic notation: &#8220;2001:db8:a0b:12f0::1&#8221;</p>
<p id="rfc.section.6.12.p.8">CBOR encoding: 74 323030313A6462383A6130623A313266303A3A31</p>
<h1 id="rfc.section.6.13">
<a href="#rfc.section.6.13">6.13.</a> <a href="#the-instance-identifier-type" id="the-instance-identifier-type">The &#8216;instance-identifier&#8217; Type</a>
</h1>
<p id="rfc.section.6.13.p.1">This specification supports two approaches for encoding an instance-identifier, one based on YANG Schema Item iDentifier (SID) as defined in <a href="#sid" class="xref">Section 3.2</a> and one based on names as defined in <a href="#name" class="xref">Section 3.3</a>.</p>
<h1 id="rfc.section.6.13.1">
<a href="#rfc.section.6.13.1">6.13.1.</a> <a href="#instance-identifier-with-sid" id="instance-identifier-with-sid">SIDs as instance-identifier</a>
</h1>
<p id="rfc.section.6.13.1.p.1">SIDs uniquely identify a schema node. In the case of a single instance schema node, i.e. a schema node defined at the root of a YANG module or submodule or schema nodes defined within a container, the SID is sufficient to identify this instance.</p>
<p id="rfc.section.6.13.1.p.2">In the case of a schema node member of a YANG list, a SID is combined with the list key(s) to identify each instance within the YANG list(s).</p>
<p id="rfc.section.6.13.1.p.3">Single instance schema nodes MUST be encoded using a CBOR unsigned integer data item (major type 0) and set to the targeted schema node SID.</p>
<p id="rfc.section.6.13.1.p.4">Schema nodes member of a YANG list MUST be encoded using a CBOR array data item (major type 4) containing the following entries:</p>
<p></p>

<ul>
<li>The first entry MUST be encoded as a CBOR unsigned integer data item (major type 0) and set to the targeted schema node SID.</li>
<li>The following entries MUST contain the value of each key required to identify the instance of the targeted schema node. These keys MUST be ordered as defined in the &#8216;key&#8217; YANG statement, starting from top level list, and follow by each of the subordinate list(s).</li>
</ul>
<p id="rfc.section.6.13.1.p.6">Examples within this section assume the definition of a schema node of type &#8216;instance-identifier&#8217;:</p>
<p id="rfc.section.6.13.1.p.7">Definition example from <a href="#RFC7950" class="xref">[RFC7950]</a>:</p>
<pre>
container system {
  ...
  leaf reporting-entity {
    type instance-identifier;
  }
</pre>
<p id="rfc.section.6.13.1.p.8">leaf contact { type string; }</p>
<p id="rfc.section.6.13.1.p.9">leaf hostname { type inet:domain-name; } } ~~~~</p>
<p><strong>First example:</strong></p>
<p id="rfc.section.6.13.1.p.11">The following example shows the encoding of the &#8216;reporting-entity&#8217; value referencing data node instance &#8220;/system/contact&#8221; (SID 1741).</p>
<p id="rfc.section.6.13.1.p.12">Definition example from <a href="#RFC7317" class="xref">[RFC7317]</a>:</p>
<pre>
container system {

  leaf contact {
    type string;
  }

  leaf hostname {
    type inet:domain-name;
  }
}
</pre>
<p id="rfc.section.6.13.1.p.13">CBOR diagnostic notation: 1741</p>
<p id="rfc.section.6.13.1.p.14">CBOR encoding: 19 06CD</p>
<p><strong>Second example:</strong></p>
<p id="rfc.section.6.13.1.p.16">The following example shows the encoding of the &#8216;reporting-entity&#8217; value referencing list instance &#8220;/system/authentication/user/authorized-key/key-data&#8221; (SID 1734) for user name &#8220;bob&#8221; and authorized-key &#8220;admin&#8221;.</p>
<p id="rfc.section.6.13.1.p.17">Definition example from <a href="#RFC7317" class="xref">[RFC7317]</a>:</p>
<pre>
list user {
  key name;

  leaf name {
    type string;
  }
  leaf password {
    type ianach:crypt-hash;
  }

  list authorized-key {
    key name;

    leaf name {
      type string;
    }
    leaf algorithm {
      type string;
    }
    leaf key-data {
      type binary;
  }
}
</pre>
<p id="rfc.section.6.13.1.p.18">CBOR diagnostic notation: [1734, &#8220;bob&#8221;, &#8220;admin&#8221;]</p>
<p id="rfc.section.6.13.1.p.19">CBOR encoding:</p>
<pre>
83               # array(3)
   19 06C6       # unsigned(1734)
   63            # text(3)
      626F62     # "bob"
   65            # text(5)
      61646D696E # "admin"
</pre>
<p><strong>Third example:</strong></p>
<p id="rfc.section.6.13.1.p.21">The following example shows the encoding of the &#8216;reporting-entity&#8217; value referencing the list instance &#8220;/system/authentication/user&#8221; (SID 1730) corresponding to user name &#8220;jack&#8221;.</p>
<p id="rfc.section.6.13.1.p.22">CBOR diagnostic notation: [1730, &#8220;jack&#8221;]</p>
<p id="rfc.section.6.13.1.p.23">CBOR encoding:</p>
<pre>
82             # array(2)
   19 06C2     # unsigned(1730)
   64          # text(4)
      6A61636B # "jack"
</pre>
<h1 id="rfc.section.6.13.2">
<a href="#rfc.section.6.13.2">6.13.2.</a> <a href="#names-as-instance-identifier" id="names-as-instance-identifier">Names as instance-identifier</a>
</h1>
<p id="rfc.section.6.13.2.p.1">An &#8220;instance-identifier&#8221; value is encoded as a string that is analogical to the lexical representation in XML encoding; see Section 9.13.2 in <a href="#RFC7950" class="xref">[RFC7950]</a>. However, the encoding of namespaces in instance-identifier values follows the rules stated in <a href="#name" class="xref">Section 3.3</a>, namely:</p>
<p></p>

<ul>
<li>The leftmost (top-level) data node name is always in the namespace qualified form.</li>
<li>Any subsequent data node name is in the namespace qualified form if the node is defined in a module other than its parent node, and the simple form is used otherwise. This rule also holds for node names appearing in predicates.</li>
</ul>
<p id="rfc.section.6.13.2.p.3">For example,</p>
<p id="rfc.section.6.13.2.p.4">/ietf-interfaces:interfaces/interface[name=&#8217;eth0&#8217;]/ietf-ip:ipv4/ip</p>
<p id="rfc.section.6.13.2.p.5">is a valid instance-identifier value because the data nodes &#8220;interfaces&#8221;, &#8220;interface&#8221;, and &#8220;name&#8221; are defined in the module &#8220;ietf-interfaces&#8221;, whereas &#8220;ipv4&#8221; and &#8220;ip&#8221; are defined in &#8220;ietf-ip&#8221;.</p>
<p id="rfc.section.6.13.2.p.6">The resulting xpath MUST be encoded using a CBOR text string data item (major type 3).</p>
<p><strong>First example:</strong></p>
<p id="rfc.section.6.13.2.p.8">This example is described in <a href="#instance-identifier-with-sid" class="xref">Section 6.13.1</a>.</p>
<p id="rfc.section.6.13.2.p.9">CBOR diagnostic notation: &#8220;/ietf-system:system/contact&#8221;</p>
<p id="rfc.section.6.13.2.p.10">CBOR encoding:</p>
<pre>
78 1c 2F696574662D73797374656D3A73797374656D2F636F6E74616374
</pre>
<p><strong>Second example:</strong></p>
<p id="rfc.section.6.13.2.p.12">This example is described in <a href="#instance-identifier-with-sid" class="xref">Section 6.13.1</a>.</p>
<p id="rfc.section.6.13.2.p.13">CBOR diagnostic notation:</p>
<pre>
"/ietf-system:system/authentication/user[name='bob']/authorized-key
[name='admin']/key-data"
</pre>
<p id="rfc.section.6.13.2.p.14">CBOR encoding:</p>
<pre>
78 59
   2F696574662D73797374656D3A73797374656D2F61757468656E74696361
   74696F6E2F757365725B6E616D653D27626F62275D2F617574686F72697A
   65642D6B65790D0A5B6E616D653D2761646D696E275D2F6B65792D64617461
</pre>
<p><strong>Third example:</strong></p>
<p id="rfc.section.6.13.2.p.16">This example is described in <a href="#instance-identifier-with-sid" class="xref">Section 6.13.1</a>.</p>
<p id="rfc.section.6.13.2.p.17">CBOR diagnostic notation:</p>
<pre>
"/ietf-system:system/authentication/user[name='bob']"
</pre>
<p id="rfc.section.6.13.2.p.18">CBOR encoding:</p>
<pre>
78 33
   2F696574662D73797374656D3A73797374656D2F61757468656E74696361
   74696F6E2F757365725B6E616D653D27626F62275D
</pre>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">The security considerations of <a href="#RFC7049" class="xref">[RFC7049]</a> and <a href="#RFC7950" class="xref">[RFC7950]</a> apply.</p>
<p id="rfc.section.7.p.2">This document defines an alternative encoding for data modeled in the YANG data modeling language. As such, this encoding does not contribute any new security issues in addition of those identified for the specific protocol or context for which it is used.</p>
<p id="rfc.section.7.p.3">To minimize security risks, software on the receiving side SHOULD reject all messages that do not comply to the rules of this document and reply with an appropriate error message to the sender.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> <a href="#tag-registry" id="tag-registry">Tags Registry</a>
</h1>
<p id="rfc.section.8.1.p.1">This specification requires the assignment of CBOR tags for the following YANG datatypes.  These tags are added to the Tags Registry as defined in section 7.2 of <a href="#RFC7049" class="xref">[RFC7049]</a>.</p>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Tag</th>
<th class="left">Data Item</th>
<th class="left">Semantics</th>
<th class="left">Reference</th>
</tr></thead>
<tbody>
<tr>
<td class="left">xx</td>
<td class="left">SID</td>
<td class="left">YANG Schema Item iDentifier</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">xx</td>
<td class="left">bits</td>
<td class="left">YANG bits datatype</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">xx</td>
<td class="left">enumeration</td>
<td class="left">YANG enumeration datatype</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">xx</td>
<td class="left">identityref</td>
<td class="left">YANG identityref datatype</td>
<td class="left">RFC XXXX</td>
</tr>
<tr>
<td class="left">xx</td>
<td class="left">instance-identifier</td>
<td class="left">YANG instance-identifier datatype</td>
<td class="left">RFC XXXX</td>
</tr>
</tbody>
</table>
<p id="rfc.section.8.1.p.2">// RFC Ed.: update Tag values using allocated tags and remove this note // RFC Ed.: replace XXXX with RFC number and remove this note</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#acknowledgments" id="acknowledgments">Acknowledgments</a>
</h1>
<p id="rfc.section.9.p.1">This document has been largely inspired by the extensive works done by Andy Bierman and Peter van der Stok on <a href="#I-D.ietf-core-comi" class="xref">[I-D.ietf-core-comi]</a>. <a href="#RFC7951" class="xref">[RFC7951]</a> has also been a critical input to this work. The authors would like to thank the authors and contributors to these two drafts.</p>
<p id="rfc.section.9.p.2">The authors would also like to acknowledge the review, feedback, and comments from Ladislav Lhotka and Juergen Schoenwaelder.</p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6241">[RFC6241]</b></td>
<td class="top">
<a>Enns, R.</a>, <a>Bjorklund, M.</a>, <a>Schoenwaelder, J.</a> and <a>A. Bierman</a>, "<a href="https://tools.ietf.org/html/rfc6241">Network Configuration Protocol (NETCONF)</a>", RFC 6241, DOI 10.17487/RFC6241, June 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7049">[RFC7049]</b></td>
<td class="top">
<a>Bormann, C.</a> and <a>P. Hoffman</a>, "<a href="https://tools.ietf.org/html/rfc7049">Concise Binary Object Representation (CBOR)</a>", RFC 7049, DOI 10.17487/RFC7049, October 2013.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7950">[RFC7950]</b></td>
<td class="top">
<a>Bjorklund, M.</a>, "<a href="https://tools.ietf.org/html/rfc7950">The YANG 1.1 Data Modeling Language</a>", RFC 7950, DOI 10.17487/RFC7950, August 2016.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-core-comi">[I-D.ietf-core-comi]</b></td>
<td class="top">
<a>Veillette, M.</a>, <a>Stok, P.</a>, <a>Pelov, A.</a> and <a>A. Bierman</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-comi-04">CoAP Management Interface</a>", Internet-Draft draft-ietf-core-comi-04, November 2018.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-sid">[I-D.ietf-core-sid]</b></td>
<td class="top">
<a>Veillette, M.</a>, <a>Pelov, A.</a> and <a>I. Petrov</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-sid-06">YANG Schema Item iDentifier (SID)</a>", Internet-Draft draft-ietf-core-sid-06, March 2019.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7159">[RFC7159]</b></td>
<td class="top">
<a>Bray, T.</a>, "<a href="https://tools.ietf.org/html/rfc7159">The JavaScript Object Notation (JSON) Data Interchange Format</a>", RFC 7159, DOI 10.17487/RFC7159, March 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7223">[RFC7223]</b></td>
<td class="top">
<a>Bjorklund, M.</a>, "<a href="https://tools.ietf.org/html/rfc7223">A YANG Data Model for Interface Management</a>", RFC 7223, DOI 10.17487/RFC7223, May 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7228">[RFC7228]</b></td>
<td class="top">
<a>Bormann, C.</a>, <a>Ersue, M.</a> and <a>A. Keranen</a>, "<a href="https://tools.ietf.org/html/rfc7228">Terminology for Constrained-Node Networks</a>", RFC 7228, DOI 10.17487/RFC7228, May 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7277">[RFC7277]</b></td>
<td class="top">
<a>Bjorklund, M.</a>, "<a href="https://tools.ietf.org/html/rfc7277">A YANG Data Model for IP Management</a>", RFC 7277, DOI 10.17487/RFC7277, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7317">[RFC7317]</b></td>
<td class="top">
<a>Bierman, A.</a> and <a>M. Bjorklund</a>, "<a href="https://tools.ietf.org/html/rfc7317">A YANG Data Model for System Management</a>", RFC 7317, DOI 10.17487/RFC7317, August 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7951">[RFC7951]</b></td>
<td class="top">
<a>Lhotka, L.</a>, "<a href="https://tools.ietf.org/html/rfc7951">JSON Encoding of Data Modeled with YANG</a>", RFC 7951, DOI 10.17487/RFC7951, August 2016.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8040">[RFC8040]</b></td>
<td class="top">
<a>Bierman, A.</a>, <a>Bjorklund, M.</a> and <a>K. Watsen</a>, "<a href="https://tools.ietf.org/html/rfc8040">RESTCONF Protocol</a>", RFC 8040, DOI 10.17487/RFC8040, January 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8348">[RFC8348]</b></td>
<td class="top">
<a>Bierman, A.</a>, <a>Bjorklund, M.</a>, <a>Dong, J.</a> and <a>D. Romascanu</a>, "<a href="https://tools.ietf.org/html/rfc8348">A YANG Data Model for Hardware Management</a>", RFC 8348, DOI 10.17487/RFC8348, March 2018.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Michel Veillette</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Veillette</span>
	  </span>
	</span>
	<span class="org vcardline">Trilliant Networks Inc.</span>
	<span class="adr">
	  <span class="vcardline">610 Rue du Luxembourg</span>

	  <span class="vcardline">
		<span class="locality">Granby</span>,  
		<span class="region">Quebec</span> 
		<span class="code">J2J 2V2</span>
	  </span>
	  <span class="country-name vcardline">Canada</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:michel.veillette@trilliantinc.com">michel.veillette@trilliantinc.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ivaylo Petrov</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Petrov</span>
	  </span>
	</span>
	<span class="org vcardline">Acklio</span>
	<span class="adr">
	  <span class="vcardline">1137A avenue des Champs Blancs</span>

	  <span class="vcardline">
		<span class="locality">Cesson-Sevigne</span>,  
		<span class="region">Bretagne</span> 
		<span class="code">35510</span>
	  </span>
	  <span class="country-name vcardline">France</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ivaylo@ackl.io">ivaylo@ackl.io</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Alexander Pelov</span> 
	  <span class="n hidden">
		<span class="family-name">Pelov</span>
	  </span>
	</span>
	<span class="org vcardline">Acklio</span>
	<span class="adr">
	  <span class="vcardline">1137A avenue des Champs Blancs</span>

	  <span class="vcardline">
		<span class="locality">Cesson-Sevigne</span>,  
		<span class="region">Bretagne</span> 
		<span class="code">35510</span>
	  </span>
	  <span class="country-name vcardline">France</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:a@ackl.io">a@ackl.io</a></span>

  </address>
</div>

  <div class="github-fork-ribbon-wrapper"><div class="github-fork-ribbon"><a href="https://github.com/core-wg/yang-cbor">Fork me on GitHub</a></div></div>
</body>
</html>
